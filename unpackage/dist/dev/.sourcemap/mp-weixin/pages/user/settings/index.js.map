{"version":3,"file":"index.js","sources":["pages/user/settings/index.vue","D:/比赛软件/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9zZXR0aW5ncy9pbmRleC52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"container\" :class=\"{ 'large-font': largeFontMode }\">\r\n\t\t<view class=\"settings-section\">\r\n\t\t\t<view class=\"section-title\">显示设置</view>\r\n\t\t\t<view class=\"setting-item\">\r\n\t\t\t\t<view class=\"setting-info\">\r\n\t\t\t\t\t<text class=\"setting-label\">大字体模式</text>\r\n\t\t\t\t\t<text class=\"setting-desc\">适合老年人使用，字体和按钮更大</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<switch :checked=\"largeFontMode\" @change=\"toggleLargeFont\" color=\"#2F85FC\" />\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"settings-section\">\r\n\t\t\t<view class=\"section-title\">账户信息</view>\r\n\t\t\t<view class=\"setting-item\" v-if=\"userInfo\">\r\n\t\t\t\t<text class=\"setting-label\">用户名</text>\r\n\t\t\t\t<text class=\"setting-value\">{{ userInfo.name || userInfo.phone }}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"setting-item\" v-if=\"userInfo\">\r\n\t\t\t\t<text class=\"setting-label\">手机号</text>\r\n\t\t\t\t<text class=\"setting-value\">{{ userInfo.phone }}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"setting-item\" v-if=\"!isLoggedIn\" @click=\"login\">\r\n\t\t\t\t<text class=\"setting-label\">登录/注册</text>\r\n\t\t\t\t<text class=\"setting-arrow\">></text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"settings-section\">\r\n\t\t\t<view class=\"section-title\">数据管理</view>\r\n\t\t\t<view class=\"setting-item\" @click=\"viewDrafts\">\r\n\t\t\t\t<text class=\"setting-label\">草稿箱</text>\r\n\t\t\t\t<text class=\"setting-badge\" v-if=\"draftCount > 0\">{{ draftCount }}</text>\r\n\t\t\t\t<text class=\"setting-arrow\">></text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"setting-item\" @click=\"clearCache\">\r\n\t\t\t\t<text class=\"setting-label\">清除缓存</text>\r\n\t\t\t\t<text class=\"setting-arrow\">></text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"settings-section\" v-if=\"isLoggedIn\">\r\n\t\t\t<view class=\"setting-item logout\" @click=\"logout\">\r\n\t\t\t\t<text class=\"setting-label logout-text\">退出登录</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport userStore from '@/store/user.js';\r\n\timport offline from '@/utils/offline.js';\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tlargeFontMode: false,\r\n\t\t\t\tisLoggedIn: false,\r\n\t\t\t\tuserInfo: null,\r\n\t\t\t\tdraftCount: 0\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.loadSettings();\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\t// 每次显示时刷新草稿数量\r\n\t\t\tthis.draftCount = offline.draftDemand.getAll().length;\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t/**\r\n\t\t\t * 加载设置\r\n\t\t\t */\r\n\t\t\tloadSettings() {\r\n\t\t\t\tthis.largeFontMode = userStore.state.largeFontMode;\r\n\t\t\t\tthis.isLoggedIn = userStore.state.isLoggedIn;\r\n\t\t\t\tthis.userInfo = userStore.state.userInfo;\r\n\t\t\t\tthis.draftCount = offline.draftDemand.getAll().length;\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 切换大字体模式\r\n\t\t\t */\r\n\t\t\ttoggleLargeFont(e) {\r\n\t\t\t\tuserStore.toggleLargeFontMode();\r\n\t\t\t\tthis.largeFontMode = userStore.state.largeFontMode;\r\n\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: this.largeFontMode ? '已开启大字体模式' : '已关闭大字体模式',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 登录\r\n\t\t\t */\r\n\t\t\tlogin() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/user/login/index'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 查看草稿\r\n\t\t\t */\r\n\t\t\tviewDrafts() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/user/demand/drafts'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 清除缓存\r\n\t\t\t */\r\n\t\t\tclearCache() {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '确认清除',\r\n\t\t\t\t\tcontent: '确定要清除所有缓存数据吗？',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t// 清除草稿（保留已同步的）\r\n\t\t\t\t\t\t\tconst drafts = offline.draftDemand.getAll();\r\n\t\t\t\t\t\t\tconst syncedDrafts = drafts.filter(d => {\r\n\t\t\t\t\t\t\t\tconst queue = offline.syncQueue.getAll();\r\n\t\t\t\t\t\t\t\treturn !queue.find(q => q.local_id === d.offline_local_id);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\toffline.draftDemand.clear();\r\n\t\t\t\t\t\t\tsyncedDrafts.forEach(d => {\r\n\t\t\t\t\t\t\t\toffline.draftDemand.save(d);\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '缓存已清除',\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tthis.draftCount = offline.draftDemand.getAll().length;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 退出登录\r\n\t\t\t */\r\n\t\t\tlogout() {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '确认退出',\r\n\t\t\t\t\tcontent: '确定要退出登录吗？',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\tuserStore.clearUserInfo();\r\n\t\t\t\t\t\t\tthis.isLoggedIn = false;\r\n\t\t\t\t\t\t\tthis.userInfo = null;\r\n\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '已退出登录',\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style scoped>\r\n\t.container {\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tmin-height: 100vh;\r\n\t}\r\n\r\n\t.settings-section {\r\n\t\tbackground-color: #fff;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.section-title {\r\n\t\tpadding: 30rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #999;\r\n\t\tborder-bottom: 2rpx solid #f0f0f0;\r\n\t}\r\n\r\n\t.setting-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 30rpx;\r\n\t\tborder-bottom: 2rpx solid #f0f0f0;\r\n\t}\r\n\r\n\t.setting-item:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t.setting-info {\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.setting-label {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #333;\r\n\t\tdisplay: block;\r\n\t\tmargin-bottom: 5rpx;\r\n\t}\r\n\r\n\t.setting-desc {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t.setting-value {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t}\r\n\r\n\t.setting-arrow {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #999;\r\n\t\tmargin-left: 20rpx;\r\n\t}\r\n\r\n\t.setting-badge {\r\n\t\tbackground-color: #ff4444;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 20rpx;\r\n\t\tpadding: 4rpx 12rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\tmargin-left: 10rpx;\r\n\t}\r\n\r\n\t.logout {\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.logout-text {\r\n\t\tcolor: #ff4444;\r\n\t\ttext-align: center;\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/Administrator/Desktop/xydianan/xydianan/pages/user/settings/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["offline","userStore","uni"],"mappings":";;;;AAsDC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,eAAe;AAAA,MACf,YAAY;AAAA,MACZ,UAAU;AAAA,MACV,YAAY;AAAA;EAEb;AAAA,EACD,SAAS;AACR,SAAK,aAAY;AAAA,EACjB;AAAA,EACD,SAAS;AAER,SAAK,aAAaA,cAAO,QAAC,YAAY,OAAM,EAAG;AAAA,EAC/C;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIR,eAAe;AACd,WAAK,gBAAgBC,qBAAU,MAAM;AACrC,WAAK,aAAaA,qBAAU,MAAM;AAClC,WAAK,WAAWA,qBAAU,MAAM;AAChC,WAAK,aAAaD,cAAO,QAAC,YAAY,OAAM,EAAG;AAAA,IAC/C;AAAA;AAAA;AAAA;AAAA,IAKD,gBAAgB,GAAG;AAClBC,iBAAS,UAAC,oBAAmB;AAC7B,WAAK,gBAAgBA,qBAAU,MAAM;AAErCC,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO,KAAK,gBAAgB,aAAa;AAAA,QACzC,MAAM;AAAA,MACP,CAAC;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,QAAQ;AACPA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,aAAa;AACZA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,aAAa;AACZA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AACjB,cAAI,IAAI,SAAS;AAEhB,kBAAM,SAASF,cAAAA,QAAQ,YAAY,OAAM;AACzC,kBAAM,eAAe,OAAO,OAAO,OAAK;AACvC,oBAAM,QAAQA,cAAAA,QAAQ,UAAU,OAAM;AACtC,qBAAO,CAAC,MAAM,KAAK,OAAK,EAAE,aAAa,EAAE,gBAAgB;AAAA,YAC1D,CAAC;AACDA,kCAAQ,YAAY;AACpB,yBAAa,QAAQ,OAAK;AACzBA,4BAAAA,QAAQ,YAAY,KAAK,CAAC;AAAA,YAC3B,CAAC;AAEDE,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,YACP,CAAC;AAED,iBAAK,aAAaF,cAAO,QAAC,YAAY,OAAM,EAAG;AAAA,UAChD;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,SAAS;AACRE,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AACjB,cAAI,IAAI,SAAS;AAChBD,uBAAS,UAAC,cAAa;AACvB,iBAAK,aAAa;AAClB,iBAAK,WAAW;AAEhBC,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,YACP,CAAC;AAAA,UACF;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACF;AAAA,EACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnKF,GAAG,WAAW,eAAe;"}