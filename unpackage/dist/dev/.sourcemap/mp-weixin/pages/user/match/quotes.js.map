{"version":3,"file":"quotes.js","sources":["pages/user/match/quotes.vue","D:/比赛软件/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9tYXRjaC9xdW90ZXMudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"container\" :class=\"{ 'large-font': largeFontMode }\">\r\n\t\t<view class=\"quote-list\">\r\n\t\t\t<view \r\n\t\t\t\tclass=\"quote-item\" \r\n\t\t\t\tv-for=\"quote in quoteList\" \r\n\t\t\t\t:key=\"quote.id\"\r\n\t\t\t\t@click=\"viewQuoteDetail(quote)\"\r\n\t\t\t>\r\n\t\t\t\t<view class=\"quote-header\">\r\n\t\t\t\t\t<image :src=\"quote.master_avatar\" class=\"master-avatar\" mode=\"aspectFill\" />\r\n\t\t\t\t\t<view class=\"master-info\">\r\n\t\t\t\t\t\t<text class=\"master-name\">{{ quote.master_name }}</text>\r\n\t\t\t\t\t\t<view class=\"master-rating\">\r\n\t\t\t\t\t\t\t<text class=\"rating-star\">⭐</text>\r\n\t\t\t\t\t\t\t<text class=\"rating-value\">{{ quote.rating }}</text>\r\n\t\t\t\t\t\t\t<text class=\"rating-count\">({{ quote.order_count }}单)</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text class=\"quote-price\">¥{{ quote.total_price }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"quote-details\">\r\n\t\t\t\t\t<view class=\"detail-item\">\r\n\t\t\t\t\t\t<text class=\"detail-label\">距离：</text>\r\n\t\t\t\t\t\t<text class=\"detail-value\">{{ quote.distance }}km</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"detail-item\">\r\n\t\t\t\t\t\t<text class=\"detail-label\">工期：</text>\r\n\t\t\t\t\t\t<text class=\"detail-value\">{{ quote.work_days }}天</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"detail-item\">\r\n\t\t\t\t\t\t<text class=\"detail-label\">质保：</text>\r\n\t\t\t\t\t\t<text class=\"detail-value\">{{ quote.warranty_months }}个月</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"quote-materials\" v-if=\"quote.materials && quote.materials.length > 0\">\r\n\t\t\t\t\t<text class=\"materials-label\">材料清单：</text>\r\n\t\t\t\t\t<text class=\"materials-text\">{{ quote.materials.join('、') }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"quote-actions\">\r\n\t\t\t\t\t<button class=\"btn btn-secondary\" @click.stop=\"contactMaster(quote)\">联系师傅</button>\r\n\t\t\t\t\t<button class=\"btn btn-primary\" @click.stop=\"createOrder(quote)\">选择此报价</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"empty\" v-if=\"!loading && quoteList.length === 0\">\r\n\t\t\t<text>暂无报价</text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport request from '@/utils/request.js';\r\nimport userStore from '@/store/user.js';\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tdemandId: null,\r\n\t\t\tquoteList: [],\r\n\t\t\tloading: false,\r\n\t\t\tlargeFontMode: false\r\n\t\t};\r\n\t},\r\n\tonLoad(options) {\r\n\t\tif (options.demand_id) {\r\n\t\t\tthis.demandId = options.demand_id;\r\n\t\t\tthis.loadQuotes();\r\n\t\t}\r\n\t\t\r\n\t\tthis.largeFontMode = userStore.state.largeFontMode;\r\n\t},\r\n\tonPullDownRefresh() {\r\n\t\tthis.loadQuotes().finally(() => {\r\n\t\t\tuni.stopPullDownRefresh();\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 加载报价列表\r\n\t\t */\r\n\t\tasync loadQuotes() {\r\n\t\t\tthis.loading = true;\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await request.get('/api/demand/quote/list', {\r\n\t\t\t\t\tdemand_id: this.demandId\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tthis.quoteList = result.list || [];\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('加载报价列表失败', error);\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '加载失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 查看报价详情\r\n\t\t */\r\n\t\tviewQuoteDetail(quote) {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/user/match/quote-detail?quote_id=${quote.id}`\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 联系师傅\r\n\t\t */\r\n\t\tcontactMaster(quote) {\r\n\t\t\tuni.makePhoneCall({\r\n\t\t\t\tphoneNumber: quote.master_phone\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 创建订单\r\n\t\t */\r\n\t\tasync createOrder(quote) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '确认选择',\r\n\t\t\t\tcontent: `确定选择${quote.master_name}的报价吗？`,\r\n\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tconst result = await request.post('/api/order/create', {\r\n\t\t\t\t\t\t\t\tquote_id: quote.id,\r\n\t\t\t\t\t\t\t\twarranty_months: quote.warranty_months || 12\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '订单创建成功',\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\t\turl: `/pages/user/order/detail?order_id=${result.id}`\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}, 1500);\r\n\t\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t\tconsole.error('创建订单失败', error);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n\tbackground-color: #f5f5f5;\r\n\tmin-height: 100vh;\r\n\tpadding: 20rpx;\r\n}\r\n\r\n.quote-list {\r\n\t\r\n}\r\n\r\n.quote-item {\r\n\tbackground-color: #fff;\r\n\tborder-radius: 12rpx;\r\n\tpadding: 30rpx;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.quote-header {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.master-avatar {\r\n\twidth: 100rpx;\r\n\theight: 100rpx;\r\n\tborder-radius: 50rpx;\r\n\tmargin-right: 20rpx;\r\n}\r\n\r\n.master-info {\r\n\tflex: 1;\r\n}\r\n\r\n.master-name {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333;\r\n\tdisplay: block;\r\n\tmargin-bottom: 10rpx;\r\n}\r\n\r\n.master-rating {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n}\r\n\r\n.rating-star {\r\n\tfont-size: 24rpx;\r\n\tmargin-right: 5rpx;\r\n}\r\n\r\n.rating-value {\r\n\tfont-size: 28rpx;\r\n\tcolor: #ff9800;\r\n\tmargin-right: 10rpx;\r\n}\r\n\r\n.rating-count {\r\n\tfont-size: 24rpx;\r\n\tcolor: #999;\r\n}\r\n\r\n.quote-price {\r\n\tfont-size: 40rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #2F85FC;\r\n}\r\n\r\n.quote-details {\r\n\tdisplay: flex;\r\n\tgap: 30rpx;\r\n\tmargin-bottom: 20rpx;\r\n\tpadding: 20rpx;\r\n\tbackground-color: #f5f5f5;\r\n\tborder-radius: 8rpx;\r\n}\r\n\r\n.detail-item {\r\n\tfont-size: 24rpx;\r\n}\r\n\r\n.detail-label {\r\n\tcolor: #666;\r\n}\r\n\r\n.detail-value {\r\n\tcolor: #333;\r\n\tfont-weight: bold;\r\n}\r\n\r\n.quote-materials {\r\n\tmargin-bottom: 20rpx;\r\n\tpadding: 20rpx;\r\n\tbackground-color: #f9f9f9;\r\n\tborder-radius: 8rpx;\r\n}\r\n\r\n.materials-label {\r\n\tfont-size: 24rpx;\r\n\tcolor: #666;\r\n\tmargin-right: 10rpx;\r\n}\r\n\r\n.materials-text {\r\n\tfont-size: 24rpx;\r\n\tcolor: #333;\r\n}\r\n\r\n.quote-actions {\r\n\tdisplay: flex;\r\n\tgap: 20rpx;\r\n}\r\n\r\n.btn {\r\n\tflex: 1;\r\n\theight: 80rpx;\r\n\tline-height: 80rpx;\r\n\ttext-align: center;\r\n\tborder-radius: 8rpx;\r\n\tfont-size: 28rpx;\r\n\tborder: none;\r\n}\r\n\r\n.btn-primary {\r\n\tbackground-color: #2F85FC;\r\n\tcolor: #fff;\r\n}\r\n\r\n.btn-secondary {\r\n\tbackground-color: #f0f0f0;\r\n\tcolor: #666;\r\n}\r\n\r\n.empty {\r\n\ttext-align: center;\r\n\tpadding: 100rpx 0;\r\n\tfont-size: 28rpx;\r\n\tcolor: #999;\r\n}\r\n</style>\r\n\r\n\r\n","import MiniProgramPage from 'C:/Users/Administrator/Desktop/xydianan/xydianan/pages/user/match/quotes.vue'\nwx.createPage(MiniProgramPage)"],"names":["userStore","uni","request"],"mappings":";;;;AA2DA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,UAAU;AAAA,MACV,WAAW,CAAE;AAAA,MACb,SAAS;AAAA,MACT,eAAe;AAAA;EAEhB;AAAA,EACD,OAAO,SAAS;AACf,QAAI,QAAQ,WAAW;AACtB,WAAK,WAAW,QAAQ;AACxB,WAAK,WAAU;AAAA,IAChB;AAEA,SAAK,gBAAgBA,qBAAU,MAAM;AAAA,EACrC;AAAA,EACD,oBAAoB;AACnB,SAAK,aAAa,QAAQ,MAAM;AAC/BC,oBAAG,MAAC,oBAAmB;AAAA,IACxB,CAAC;AAAA,EACD;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIR,MAAM,aAAa;AAClB,WAAK,UAAU;AAEf,UAAI;AACH,cAAM,SAAS,MAAMC,sBAAQ,IAAI,0BAA0B;AAAA,UAC1D,WAAW,KAAK;AAAA,QACjB,CAAC;AAED,aAAK,YAAY,OAAO,QAAQ,CAAA;AAAA,MAC/B,SAAO,OAAO;AACfD,sBAAA,MAAA,MAAA,SAAA,qCAAc,YAAY,KAAK;AAC/BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,MACF,UAAU;AACT,aAAK,UAAU;AAAA,MAChB;AAAA,IACA;AAAA;AAAA;AAAA;AAAA,IAKD,gBAAgB,OAAO;AACtBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,2CAA2C,MAAM,EAAE;AAAA,MACzD,CAAC;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,cAAc,OAAO;AACpBA,oBAAAA,MAAI,cAAc;AAAA,QACjB,aAAa,MAAM;AAAA,MACpB,CAAC;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,MAAM,YAAY,OAAO;AACxBA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS,OAAO,MAAM,WAAW;AAAA,QACjC,SAAS,OAAO,QAAQ;AACvB,cAAI,IAAI,SAAS;AAChB,gBAAI;AACH,oBAAM,SAAS,MAAMC,sBAAQ,KAAK,qBAAqB;AAAA,gBACtD,UAAU,MAAM;AAAA,gBAChB,iBAAiB,MAAM,mBAAmB;AAAA,cAC3C,CAAC;AAEDD,4BAAAA,MAAI,UAAU;AAAA,gBACb,OAAO;AAAA,gBACP,MAAM;AAAA,cACP,CAAC;AAED,yBAAW,MAAM;AAChBA,8BAAAA,MAAI,WAAW;AAAA,kBACd,KAAK,qCAAqC,OAAO,EAAE;AAAA,gBACpD,CAAC;AAAA,cACD,GAAE,IAAI;AAAA,YACN,SAAO,OAAO;AACfA,4BAAc,MAAA,MAAA,SAAA,sCAAA,UAAU,KAAK;AAAA,YAC9B;AAAA,UACD;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3JA,GAAG,WAAW,eAAe;"}