{"version":3,"file":"masters.js","sources":["pages/user/match/masters.vue","D:/比赛软件/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9tYXRjaC9tYXN0ZXJzLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"container\" :class=\"{ 'large-font': largeFontMode }\">\r\n\t\t<view class=\"filter-bar\">\r\n\t\t\t<view class=\"filter-item\" @click=\"showSortModal = true\">\r\n\t\t\t\t<text>排序：{{ sortText }}</text>\r\n\t\t\t\t<text class=\"filter-arrow\">▼</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"master-list\">\r\n\t\t\t<view \r\n\t\t\t\tclass=\"master-item\" \r\n\t\t\t\tv-for=\"master in masterList\" \r\n\t\t\t\t:key=\"master.id\"\r\n\t\t\t\t@click=\"viewMasterDetail(master)\"\r\n\t\t\t>\r\n\t\t\t\t<image :src=\"master.avatar\" class=\"master-avatar\" mode=\"aspectFill\" />\r\n\t\t\t\t<view class=\"master-info\">\r\n\t\t\t\t\t<view class=\"master-header\">\r\n\t\t\t\t\t\t<text class=\"master-name\">{{ master.name }}</text>\r\n\t\t\t\t\t\t<view class=\"master-rating\">\r\n\t\t\t\t\t\t\t<text class=\"rating-star\">⭐</text>\r\n\t\t\t\t\t\t\t<text class=\"rating-value\">{{ master.rating }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"master-tags\">\r\n\t\t\t\t\t\t<text class=\"tag\" v-for=\"tag in master.tags\" :key=\"tag\">{{ tag }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"master-footer\">\r\n\t\t\t\t\t\t<text class=\"distance\">距离 {{ master.distance }}km</text>\r\n\t\t\t\t\t\t<text class=\"price-range\">报价：¥{{ master.min_price }} - ¥{{ master.max_price }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"load-more\" v-if=\"hasMore\">\r\n\t\t\t<text v-if=\"loading\">加载中...</text>\r\n\t\t\t<text v-else @click=\"loadMore\">加载更多</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"no-more\" v-if=\"!hasMore && masterList.length > 0\">\r\n\t\t\t<text>没有更多了</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"empty\" v-if=\"!loading && masterList.length === 0\">\r\n\t\t\t<text>暂无匹配的师傅</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 排序选择弹窗 -->\r\n\t\t<view class=\"modal\" v-if=\"showSortModal\" @click=\"showSortModal = false\">\r\n\t\t\t<view class=\"modal-content\" @click.stop>\r\n\t\t\t\t<view class=\"modal-title\">选择排序方式</view>\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"sort-option\" \r\n\t\t\t\t\tv-for=\"option in sortOptions\" \r\n\t\t\t\t\t:key=\"option.value\"\r\n\t\t\t\t\t:class=\"{ 'active': currentSort === option.value }\"\r\n\t\t\t\t\t@click=\"selectSort(option.value)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<text>{{ option.label }}</text>\r\n\t\t\t\t\t<text class=\"check-icon\" v-if=\"currentSort === option.value\">✓</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport request from '@/utils/request.js';\r\nimport userStore from '@/store/user.js';\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tdemandId: null,\r\n\t\t\tmasterList: [],\r\n\t\t\tcurrentSort: 'distance',\r\n\t\t\tsortOptions: [\r\n\t\t\t\t{ value: 'distance', label: '距离最近' },\r\n\t\t\t\t{ value: 'rating', label: '评分最高' },\r\n\t\t\t\t{ value: 'price', label: '价格最低' }\r\n\t\t\t],\r\n\t\t\tpage: 1,\r\n\t\t\tpageSize: 10,\r\n\t\t\thasMore: true,\r\n\t\t\tloading: false,\r\n\t\t\tshowSortModal: false,\r\n\t\t\tlargeFontMode: false\r\n\t\t};\r\n\t},\r\n\tcomputed: {\r\n\t\tsortText() {\r\n\t\t\tconst option = this.sortOptions.find(opt => opt.value === this.currentSort);\r\n\t\t\treturn option ? option.label : '距离最近';\r\n\t\t}\r\n\t},\r\n\tonLoad(options) {\r\n\t\tthis.demandId = options.demand_id || null;\r\n\t\tthis.largeFontMode = userStore.state.largeFontMode;\r\n\t\t// 即使没有demand_id也可以显示师傅列表\r\n\t\tthis.loadMasters();\r\n\t},\r\n\tonPullDownRefresh() {\r\n\t\tthis.page = 1;\r\n\t\tthis.masterList = [];\r\n\t\tthis.hasMore = true;\r\n\t\tthis.loadMasters().finally(() => {\r\n\t\t\tuni.stopPullDownRefresh();\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 加载师傅列表\r\n\t\t */\r\n\t\tasync loadMasters() {\r\n\t\t\tif (this.loading) return;\r\n\t\t\t\r\n\t\t\tthis.loading = true;\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst params = {\r\n\t\t\t\t\tsort: this.currentSort,\r\n\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\tpage_size: this.pageSize\r\n\t\t\t\t};\r\n\t\t\t\t// 如果有demand_id才传递\r\n\t\t\t\tif (this.demandId) {\r\n\t\t\t\t\tparams.demand_id = this.demandId;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst result = await request.get('/api/match/masters', params);\r\n\t\t\t\t\r\n\t\t\t\tif (result.list && result.list.length > 0) {\r\n\t\t\t\t\tthis.masterList = this.masterList.concat(result.list);\r\n\t\t\t\t\tthis.hasMore = result.list.length >= this.pageSize;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.hasMore = false;\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('加载师傅列表失败', error);\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '加载失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 选择排序方式\r\n\t\t */\r\n\t\tselectSort(sort) {\r\n\t\t\tthis.currentSort = sort;\r\n\t\t\tthis.showSortModal = false;\r\n\t\t\tthis.page = 1;\r\n\t\t\tthis.masterList = [];\r\n\t\t\tthis.hasMore = true;\r\n\t\t\tthis.loadMasters();\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 加载更多\r\n\t\t */\r\n\t\tloadMore() {\r\n\t\t\tif (this.hasMore && !this.loading) {\r\n\t\t\t\tthis.page++;\r\n\t\t\t\tthis.loadMasters();\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 查看师傅详情\r\n\t\t */\r\n\t\tviewMasterDetail(master) {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/user/match/master-detail?master_id=${master.id}&demand_id=${this.demandId}`\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n\tbackground-color: #f5f5f5;\r\n\tmin-height: 100vh;\r\n}\r\n\r\n.filter-bar {\r\n\tbackground-color: #fff;\r\n\tpadding: 20rpx;\r\n\tborder-bottom: 2rpx solid #e0e0e0;\r\n}\r\n\r\n.filter-item {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tfont-size: 28rpx;\r\n\tcolor: #333;\r\n}\r\n\r\n.filter-arrow {\r\n\tfont-size: 24rpx;\r\n\tcolor: #999;\r\n}\r\n\r\n.master-list {\r\n\tpadding: 20rpx;\r\n}\r\n\r\n.master-item {\r\n\tbackground-color: #fff;\r\n\tborder-radius: 12rpx;\r\n\tpadding: 30rpx;\r\n\tmargin-bottom: 20rpx;\r\n\tdisplay: flex;\r\n}\r\n\r\n.master-avatar {\r\n\twidth: 120rpx;\r\n\theight: 120rpx;\r\n\tborder-radius: 60rpx;\r\n\tmargin-right: 20rpx;\r\n}\r\n\r\n.master-info {\r\n\tflex: 1;\r\n}\r\n\r\n.master-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tmargin-bottom: 10rpx;\r\n}\r\n\r\n.master-name {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333;\r\n}\r\n\r\n.master-rating {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n}\r\n\r\n.rating-star {\r\n\tfont-size: 24rpx;\r\n\tmargin-right: 5rpx;\r\n}\r\n\r\n.rating-value {\r\n\tfont-size: 28rpx;\r\n\tcolor: #ff9800;\r\n}\r\n\r\n.master-tags {\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\tgap: 10rpx;\r\n\tmargin-bottom: 10rpx;\r\n}\r\n\r\n.tag {\r\n\tpadding: 6rpx 12rpx;\r\n\tbackground-color: #f0f0f0;\r\n\tborder-radius: 6rpx;\r\n\tfont-size: 24rpx;\r\n\tcolor: #666;\r\n}\r\n\r\n.master-footer {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\tfont-size: 24rpx;\r\n\tcolor: #999;\r\n}\r\n\r\n.distance {\r\n\tcolor: #2F85FC;\r\n}\r\n\r\n.price-range {\r\n\tcolor: #ff9800;\r\n\tfont-weight: bold;\r\n}\r\n\r\n.load-more, .no-more, .empty {\r\n\ttext-align: center;\r\n\tpadding: 40rpx;\r\n\tfont-size: 28rpx;\r\n\tcolor: #999;\r\n}\r\n\r\n.modal {\r\n\tposition: fixed;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tbottom: 0;\r\n\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tz-index: 999;\r\n}\r\n\r\n.modal-content {\r\n\tbackground-color: #fff;\r\n\tborder-radius: 12rpx;\r\n\twidth: 600rpx;\r\n\tmax-height: 80vh;\r\n\toverflow-y: auto;\r\n}\r\n\r\n.modal-title {\r\n\tpadding: 30rpx;\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333;\r\n\tborder-bottom: 2rpx solid #e0e0e0;\r\n}\r\n\r\n.sort-option {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tpadding: 30rpx;\r\n\tborder-bottom: 2rpx solid #f0f0f0;\r\n\tfont-size: 28rpx;\r\n\tcolor: #333;\r\n}\r\n\r\n.sort-option.active {\r\n\tcolor: #2F85FC;\r\n}\r\n\r\n.check-icon {\r\n\tcolor: #2F85FC;\r\n\tfont-size: 32rpx;\r\n}\r\n</style>\r\n\r\n\r\n","import MiniProgramPage from 'C:/Users/Administrator/Desktop/xydianan/xydianan/pages/user/match/masters.vue'\nwx.createPage(MiniProgramPage)"],"names":["userStore","uni","request"],"mappings":";;;;AAwEA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,UAAU;AAAA,MACV,YAAY,CAAE;AAAA,MACd,aAAa;AAAA,MACb,aAAa;AAAA,QACZ,EAAE,OAAO,YAAY,OAAO,OAAQ;AAAA,QACpC,EAAE,OAAO,UAAU,OAAO,OAAQ;AAAA,QAClC,EAAE,OAAO,SAAS,OAAO,OAAO;AAAA,MAChC;AAAA,MACD,MAAM;AAAA,MACN,UAAU;AAAA,MACV,SAAS;AAAA,MACT,SAAS;AAAA,MACT,eAAe;AAAA,MACf,eAAe;AAAA;EAEhB;AAAA,EACD,UAAU;AAAA,IACT,WAAW;AACV,YAAM,SAAS,KAAK,YAAY,KAAK,SAAO,IAAI,UAAU,KAAK,WAAW;AAC1E,aAAO,SAAS,OAAO,QAAQ;AAAA,IAChC;AAAA,EACA;AAAA,EACD,OAAO,SAAS;AACf,SAAK,WAAW,QAAQ,aAAa;AACrC,SAAK,gBAAgBA,qBAAU,MAAM;AAErC,SAAK,YAAW;AAAA,EAChB;AAAA,EACD,oBAAoB;AACnB,SAAK,OAAO;AACZ,SAAK,aAAa;AAClB,SAAK,UAAU;AACf,SAAK,cAAc,QAAQ,MAAM;AAChCC,oBAAG,MAAC,oBAAmB;AAAA,IACxB,CAAC;AAAA,EACD;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIR,MAAM,cAAc;AACnB,UAAI,KAAK;AAAS;AAElB,WAAK,UAAU;AAEf,UAAI;AACH,cAAM,SAAS;AAAA,UACd,MAAM,KAAK;AAAA,UACX,MAAM,KAAK;AAAA,UACX,WAAW,KAAK;AAAA;AAGjB,YAAI,KAAK,UAAU;AAClB,iBAAO,YAAY,KAAK;AAAA,QACzB;AAEA,cAAM,SAAS,MAAMC,cAAO,QAAC,IAAI,sBAAsB,MAAM;AAE7D,YAAI,OAAO,QAAQ,OAAO,KAAK,SAAS,GAAG;AAC1C,eAAK,aAAa,KAAK,WAAW,OAAO,OAAO,IAAI;AACpD,eAAK,UAAU,OAAO,KAAK,UAAU,KAAK;AAAA,eACpC;AACN,eAAK,UAAU;AAAA,QAChB;AAAA,MACC,SAAO,OAAO;AACfD,sBAAA,MAAA,MAAA,SAAA,uCAAc,YAAY,KAAK;AAC/BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,MACF,UAAU;AACT,aAAK,UAAU;AAAA,MAChB;AAAA,IACA;AAAA;AAAA;AAAA;AAAA,IAKD,WAAW,MAAM;AAChB,WAAK,cAAc;AACnB,WAAK,gBAAgB;AACrB,WAAK,OAAO;AACZ,WAAK,aAAa;AAClB,WAAK,UAAU;AACf,WAAK,YAAW;AAAA,IAChB;AAAA;AAAA;AAAA;AAAA,IAKD,WAAW;AACV,UAAI,KAAK,WAAW,CAAC,KAAK,SAAS;AAClC,aAAK;AACL,aAAK,YAAW;AAAA,MACjB;AAAA,IACA;AAAA;AAAA;AAAA;AAAA,IAKD,iBAAiB,QAAQ;AACxBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,6CAA6C,OAAO,EAAE,cAAc,KAAK,QAAQ;AAAA,MACvF,CAAC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpLA,GAAG,WAAW,eAAe;"}