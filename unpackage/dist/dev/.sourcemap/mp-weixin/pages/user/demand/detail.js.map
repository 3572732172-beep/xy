{"version":3,"file":"detail.js","sources":["pages/user/demand/detail.vue","D:/比赛软件/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9kZW1hbmQvZGV0YWlsLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"container\" :class=\"{ 'large-font': largeFontMode }\">\n\t\t<page-header\n\t\t\ttitle=\"需求详情\"\n\t\t\tsubtitle=\"查看您的用电改造需求\"\n\t\t/>\n\t\t<view class=\"demand-card\">\n\t\t\t<view class=\"demand-header\">\n\t\t\t\t<view class=\"status-badge\" :class=\"'status-' + demandData.status\">\n\t\t\t\t\t{{ getStatusText(demandData.status) }}\n\t\t\t\t</view>\n\t\t\t\t<text class=\"demand-title\">{{ demandData.title }}</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"demand-info\">\n\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t<text class=\"info-label\">场景类型：</text>\n\t\t\t\t\t<text class=\"info-value\">{{ getSceneText(demandData.service_type) }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t<text class=\"info-label\">功率需求：</text>\n\t\t\t\t\t<text class=\"info-value\">{{ demandData.power_kw }} kW</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t<text class=\"info-label\">施工地址：</text>\n\t\t\t\t\t<text class=\"info-value\">{{ demandData.address }}</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"demand-description\">\n\t\t\t\t<text class=\"desc-label\">详细描述：</text>\n\t\t\t\t<text class=\"desc-content\">{{ demandData.description }}</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"demand-photos\" v-if=\"demandData.photos && demandData.photos.length > 0\">\n\t\t\t\t<image \n\t\t\t\t\tv-for=\"(photo, index) in demandData.photos\" \n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:src=\"photo\" \n\t\t\t\t\tclass=\"photo-item\"\n\t\t\t\t\tmode=\"aspectFill\"\n\t\t\t\t\t@click=\"previewPhoto(index)\"\n\t\t\t\t/>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<view class=\"action-section\" v-if=\"demandData.status === 1\">\n\t\t\t<button class=\"btn btn-primary\" @click=\"viewQuotes\">查看报价</button>\n\t\t\t<button class=\"btn btn-secondary\" @click=\"viewMasters\">匹配师傅</button>\n\t\t</view>\n\t\t\n\t\t<view class=\"quote-section\" v-if=\"quotes.length > 0\">\n\t\t\t<view class=\"section-title\">收到的报价</view>\n\t\t\t<view \n\t\t\t\tclass=\"quote-item\" \n\t\t\t\tv-for=\"quote in quotes\" \n\t\t\t\t:key=\"quote.id\"\n\t\t\t\t@click=\"viewQuoteDetail(quote)\"\n\t\t\t>\n\t\t\t\t<view class=\"quote-header\">\n\t\t\t\t\t<text class=\"master-name\">{{ quote.master_name }}</text>\n\t\t\t\t\t<text class=\"quote-price\">¥{{ quote.total_price }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"quote-info\">\n\t\t\t\t\t<text class=\"quote-distance\">距离 {{ quote.distance }}km</text>\n\t\t\t\t\t<text class=\"quote-rating\">评分 {{ quote.rating }}/5.0</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nimport request from '@/utils/request.js';\nimport userStore from '@/store/user.js';\nimport PageHeader from '@/components/PageHeader.vue';\n\nexport default {\n\tcomponents: {\n\t\tPageHeader\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tdemandId: null,\n\t\t\tdemandData: {},\n\t\t\tquotes: [],\n\t\t\tlargeFontMode: false\n\t\t};\n\t},\n\tonLoad(options) {\n\t\tif (options.id) {\n\t\t\tthis.demandId = options.id;\n\t\t\tthis.loadDemandDetail();\n\t\t\tthis.loadQuotes();\n\t\t}\n\t\t\n\t\tthis.largeFontMode = userStore.state.largeFontMode;\n\t},\n\tmethods: {\n\t\t/**\n\t\t * 加载需求详情\n\t\t */\n\t\tasync loadDemandDetail() {\n\t\t\ttry {\n\t\t\t\tthis.demandData = await request.get('/api/demand/detail', {\n\t\t\t\t\tid: this.demandId\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('加载需求详情失败', error);\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '加载失败',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t\n\t\t/**\n\t\t * 加载报价列表\n\t\t */\n\t\tasync loadQuotes() {\n\t\t\ttry {\n\t\t\t\tconst result = await request.get('/api/demand/quote/list', {\n\t\t\t\t\tdemand_id: this.demandId\n\t\t\t\t});\n\t\t\t\tthis.quotes = result.list || [];\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('加载报价列表失败', error);\n\t\t\t}\n\t\t},\n\t\t\n\t\t/**\n\t\t * 获取状态文本\n\t\t */\n\t\tgetStatusText(status) {\n\t\t\tconst statusMap = {\n\t\t\t\t1: '待报价',\n\t\t\t\t2: '已报价',\n\t\t\t\t3: '已接单',\n\t\t\t\t4: '已完成',\n\t\t\t\t5: '已取消'\n\t\t\t};\n\t\t\treturn statusMap[status] || '未知';\n\t\t},\n\t\t\n\t\t/**\n\t\t * 获取场景文本\n\t\t */\n\t\tgetSceneText(sceneType) {\n\t\t\tconst sceneMap = {\n\t\t\t\t1: '生活用电',\n\t\t\t\t2: '养殖棚',\n\t\t\t\t3: '加工配套',\n\t\t\t\t4: '其他'\n\t\t\t};\n\t\t\treturn sceneMap[sceneType] || '未知';\n\t\t},\n\t\t\n\t\t/**\n\t\t * 预览照片\n\t\t */\n\t\tpreviewPhoto(index) {\n\t\t\tuni.previewImage({\n\t\t\t\tcurrent: index,\n\t\t\t\turls: this.demandData.photos\n\t\t\t});\n\t\t},\n\t\t\n\t\t/**\n\t\t * 查看报价\n\t\t */\n\t\tviewQuotes() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: `/pages/user/match/quotes?demand_id=${this.demandId}`\n\t\t\t});\n\t\t},\n\t\t\n\t\t/**\n\t\t * 匹配师傅\n\t\t */\n\t\tviewMasters() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: `/pages/user/match/masters?demand_id=${this.demandId}`\n\t\t\t});\n\t\t},\n\t\t\n\t\t/**\n\t\t * 查看报价详情\n\t\t */\n\t\tviewQuoteDetail(quote) {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: `/pages/user/match/quote-detail?quote_id=${quote.id}`\n\t\t\t});\n\t\t}\n\t}\n};\n</script>\n\n<style scoped>\n.container {\n\tpadding: 0 20rpx 20rpx;\n\tbackground-color: #f0f9f4;\n\tmin-height: 100vh;\n}\n\n.demand-card {\n\tbackground-color: #fff;\n\tborder-radius: 12rpx;\n\tpadding: 30rpx;\n\tmargin-bottom: 20rpx;\n}\n\n.demand-header {\n\tmargin-bottom: 20rpx;\n}\n\n.status-badge {\n\tdisplay: inline-block;\n\tpadding: 8rpx 16rpx;\n\tborder-radius: 8rpx;\n\tfont-size: 24rpx;\n\tmargin-bottom: 10rpx;\n}\n\n.status-1 {\n\tbackground-color: #fff3cd;\n\tcolor: #856404;\n}\n\n.status-2 {\n\tbackground-color: #d1ecf1;\n\tcolor: #0c5460;\n}\n\n.status-3 {\n\tbackground-color: #d4edda;\n\tcolor: #155724;\n}\n\n.status-4 {\n\tbackground-color: #d1ecf1;\n\tcolor: #0c5460;\n}\n\n.demand-title {\n\tfont-size: 36rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n\tdisplay: block;\n\tmargin-top: 10rpx;\n}\n\n.demand-info {\n\tmargin-bottom: 20rpx;\n}\n\n.info-item {\n\tdisplay: flex;\n\tmargin-bottom: 10rpx;\n\tfont-size: 28rpx;\n}\n\n.info-label {\n\tcolor: #666;\n\twidth: 160rpx;\n}\n\n.info-value {\n\tcolor: #333;\n\tflex: 1;\n}\n\n.demand-description {\n\tmargin-bottom: 20rpx;\n}\n\n.desc-label {\n\tfont-size: 28rpx;\n\tcolor: #666;\n\tdisplay: block;\n\tmargin-bottom: 10rpx;\n}\n\n.desc-content {\n\tfont-size: 28rpx;\n\tcolor: #333;\n\tline-height: 1.6;\n}\n\n.demand-photos {\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tgap: 20rpx;\n}\n\n.photo-item {\n\twidth: 200rpx;\n\theight: 200rpx;\n\tborder-radius: 8rpx;\n}\n\n.action-section {\n\tdisplay: flex;\n\tgap: 20rpx;\n\tmargin-bottom: 20rpx;\n}\n\n.btn {\n\tflex: 1;\n\theight: 88rpx;\n\tline-height: 88rpx;\n\ttext-align: center;\n\tborder-radius: 8rpx;\n\tfont-size: 32rpx;\n\tborder: none;\n}\n\n.btn-primary {\n\tbackground-color: #2F85FC;\n\tcolor: #fff;\n}\n\n.btn-secondary {\n\tbackground-color: #f0f0f0;\n\tcolor: #666;\n}\n\n.quote-section {\n\tbackground-color: #fff;\n\tborder-radius: 12rpx;\n\tpadding: 30rpx;\n}\n\n.section-title {\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n\tmargin-bottom: 20rpx;\n}\n\n.quote-item {\n\tpadding: 20rpx;\n\tborder: 2rpx solid #e0e0e0;\n\tborder-radius: 8rpx;\n\tmargin-bottom: 20rpx;\n\tbackground-color: #fafafa;\n}\n\n.quote-header {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tmargin-bottom: 10rpx;\n}\n\n.master-name {\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n}\n\n.quote-price {\n\tfont-size: 36rpx;\n\tfont-weight: bold;\n\tcolor: #2F85FC;\n}\n\n.quote-info {\n\tdisplay: flex;\n\tgap: 30rpx;\n\tfont-size: 24rpx;\n\tcolor: #999;\n}\n</style>\n\n\n","import MiniProgramPage from 'C:/Users/Administrator/Desktop/xydianan/xydianan/pages/user/demand/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["userStore","request","uni"],"mappings":";;;;AA2EA,mBAAmB,MAAW;AAE9B,MAAK,YAAU;AAAA,EACd,YAAY;AAAA,IACX;AAAA,EACA;AAAA,EACD,OAAO;AACN,WAAO;AAAA,MACN,UAAU;AAAA,MACV,YAAY,CAAE;AAAA,MACd,QAAQ,CAAE;AAAA,MACV,eAAe;AAAA;EAEhB;AAAA,EACD,OAAO,SAAS;AACf,QAAI,QAAQ,IAAI;AACf,WAAK,WAAW,QAAQ;AACxB,WAAK,iBAAgB;AACrB,WAAK,WAAU;AAAA,IAChB;AAEA,SAAK,gBAAgBA,qBAAU,MAAM;AAAA,EACrC;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIR,MAAM,mBAAmB;AACxB,UAAI;AACH,aAAK,aAAa,MAAMC,sBAAQ,IAAI,sBAAsB;AAAA,UACzD,IAAI,KAAK;AAAA,QACV,CAAC;AAAA,MACA,SAAO,OAAO;AACfC,sBAAA,MAAA,MAAA,SAAA,uCAAc,YAAY,KAAK;AAC/BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,MACF;AAAA,IACA;AAAA;AAAA;AAAA;AAAA,IAKD,MAAM,aAAa;AAClB,UAAI;AACH,cAAM,SAAS,MAAMD,sBAAQ,IAAI,0BAA0B;AAAA,UAC1D,WAAW,KAAK;AAAA,QACjB,CAAC;AACD,aAAK,SAAS,OAAO,QAAQ,CAAA;AAAA,MAC5B,SAAO,OAAO;AACfC,sBAAA,MAAA,MAAA,SAAA,uCAAc,YAAY,KAAK;AAAA,MAChC;AAAA,IACA;AAAA;AAAA;AAAA;AAAA,IAKD,cAAc,QAAQ;AACrB,YAAM,YAAY;AAAA,QACjB,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA;AAEJ,aAAO,UAAU,MAAM,KAAK;AAAA,IAC5B;AAAA;AAAA;AAAA;AAAA,IAKD,aAAa,WAAW;AACvB,YAAM,WAAW;AAAA,QAChB,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA;AAEJ,aAAO,SAAS,SAAS,KAAK;AAAA,IAC9B;AAAA;AAAA;AAAA;AAAA,IAKD,aAAa,OAAO;AACnBA,oBAAAA,MAAI,aAAa;AAAA,QAChB,SAAS;AAAA,QACT,MAAM,KAAK,WAAW;AAAA,MACvB,CAAC;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,aAAa;AACZA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,sCAAsC,KAAK,QAAQ;AAAA,MACzD,CAAC;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,cAAc;AACbA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,uCAAuC,KAAK,QAAQ;AAAA,MAC1D,CAAC;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,gBAAgB,OAAO;AACtBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,2CAA2C,MAAM,EAAE;AAAA,MACzD,CAAC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjMA,GAAG,WAAW,eAAe;"}