{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<script>\r\n\timport userStore from './store/user.js';\r\n\r\n\texport default {\r\n\t\tonLaunch: function() {\r\n\t\t\tconsole.log('App Launch - 乡野电安需求端');\r\n\r\n\t\t\t// 初始化用户 store（从本地存储恢复登录状态）\r\n\t\t\tuserStore.loadFromStorage();\r\n\r\n\t\t\t// 如果已登录，验证token有效性（可选）\r\n\t\t\tif (userStore.state.isLoggedIn) {\r\n\t\t\t\tconsole.log('应用启动：已恢复登录状态，用户ID:', userStore.state.userInfo?.id);\r\n\t\t\t}\r\n\r\n\t\t\t// 应用大字体模式\r\n\t\t\tthis.applyFontSize();\r\n\r\n\t\t\t// 获取定位信息\r\n\t\t\tthis.getLocation();\r\n\r\n\t\t\t// #ifdef APP-NVUE\r\n\t\t\tplus.screen.lockOrientation('portrait-primary');\r\n\r\n\t\t\tlet appid = plus.runtime.appid;\r\n\t\t\tif (appid && appid.toLocaleLowerCase() != \"hbuilder\") {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: 'https://uniapp.dcloud.io/update', //检查更新的服务器地址\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tappid: plus.runtime.appid,\r\n\t\t\t\t\t\tversion: plus.runtime.version\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('success', res);\r\n\t\t\t\t\t\tif (res.statusCode == 200 && res.data.isUpdate) {\r\n\t\t\t\t\t\t\tlet openUrl = plus.os.name === 'iOS' ? res.data.iOS : res.data.Android;\r\n\t\t\t\t\t\t\t// 提醒用户更新\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\ttitle: '更新提示',\r\n\t\t\t\t\t\t\t\tcontent: res.data.note ? res.data.note : '是否选择更新',\r\n\t\t\t\t\t\t\t\tsuccess: (showResult) => {\r\n\t\t\t\t\t\t\t\t\tif (showResult.confirm) {\r\n\t\t\t\t\t\t\t\t\t\tplus.runtime.openURL(openUrl);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tvar domModule = weex.requireModule('dom');\r\n\t\t\tdomModule.addRule('fontFace', {\r\n\t\t\t\t'fontFamily': \"texticons\",\r\n\t\t\t\t'src': \"url('./static/text-icon.ttf')\"\r\n\t\t\t});\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\tonShow: function() {\r\n\t\t\tconsole.log('App Show');\r\n\r\n\t\t\t// 检查网络状态，触发离线同步\r\n\t\t\tuni.getNetworkType({\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif (res.isConnected) {\r\n\t\t\t\t\t\t// 网络可用，尝试同步离线数据\r\n\t\t\t\t\t\tconst offline = require('./utils/offline.js').default;\r\n\t\t\t\t\t\toffline.triggerSync();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tonHide: function() {\r\n\t\t\tconsole.log('App Hide')\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t/**\r\n\t\t\t * 应用字体大小\r\n\t\t\t */\r\n\t\t\tapplyFontSize() {\r\n\t\t\t\tconst fontSize = userStore.state.fontSize;\r\n\t\t\t\t// 通过设置页面根元素的 font-size 来实现大字体模式\r\n\t\t\t\t// 注意：uni-app 中需要在页面级别应用，这里设置全局变量\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\tdocument.documentElement.style.fontSize = fontSize + 'px';\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 获取定位信息\r\n\t\t\t */\r\n\t\t\tgetLocation() {\r\n\t\t\t\tuni.getLocation({\r\n\t\t\t\t\ttype: 'gcj02',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tuserStore.setLocation(res.longitude, res.latitude);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('获取定位失败', err);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t/*每个页面公共css */\r\n\r\n\t/* 大字体模式全局样式 */\r\n\t.large-font {\r\n\t\tfont-size: 18px !important;\r\n\t}\r\n\r\n\t.large-font .input,\r\n\t.large-font .textarea,\r\n\t.large-font .btn {\r\n\t\tfont-size: 18px !important;\r\n\t\tpadding: 15px;\r\n\t}\r\n\r\n\t/* #ifndef APP-NVUE */\r\n\t.large-font .input,\r\n\t.large-font .textarea,\r\n\t.large-font .btn {\r\n\t\theight: auto;\r\n\t\tmin-height: 50px;\r\n\t}\r\n\r\n\t/* #endif */\r\n\r\n\t.large-font .section-title,\r\n\t.large-font .card-title {\r\n\t\tfont-size: 20px !important;\r\n\t}\r\n</style>","import App from './App.vue'\nimport userStore from './store/user.js'\n\nconst host = 'https://api.example.com'; // 请替换为实际后端地址\n\n// #ifndef VUE3\nimport Vue from 'vue'\nVue.config.productionTip = false\nVue.prototype.$host = host;\nVue.prototype.$userStore = userStore; // 将 store 挂载到 Vue 原型上，方便全局访问\nApp.mpType = 'app'\nconst app = new Vue({\n  ...App\n})\napp.$mount()\n// #endif\n\n// #ifdef VUE3\nimport {\n\tcreateSSRApp\n} from 'vue'\nexport function createApp() {\n\tconst app = createSSRApp(App)\n\t\n\t// 将 store 挂载到 app 实例上\n\tapp.config.globalProperties.$userStore = userStore;\n\tapp.provide('userStore', userStore); // 使用 provide/inject 方式\n\t\n\treturn {\n\t\tapp\n\t}\n}\n// #endif\n"],"names":["uni","userStore","createSSRApp","App"],"mappings":";;;;;;;;;;;;;;;;;;;;AAGC,MAAK,YAAU;AAAA,EACd,UAAU,WAAW;;AACpBA,kBAAAA,MAAA,MAAA,OAAA,gBAAY,sBAAsB;AAGlCC,eAAS,UAAC,gBAAe;AAGzB,QAAIA,WAAS,UAAC,MAAM,YAAY;AAC/BD,0BAAY,MAAA,OAAA,iBAAA,uBAAsBC,gBAAAA,UAAU,MAAM,aAAhBA,mBAA0B,EAAE;AAAA,IAC/D;AAGA,SAAK,cAAa;AAGlB,SAAK,YAAW;AAAA,EAsChB;AAAA,EACD,QAAQ,WAAW;AAClBD,kBAAAA,MAAY,MAAA,OAAA,iBAAA,UAAU;AAGtBA,kBAAAA,MAAI,eAAe;AAAA,MAClB,SAAS,CAAC,QAAQ;AACjB,YAAI,IAAI,aAAa;AAEpB,gBAAM,UAAU,QAAQ,oBAAoB,EAAE;AAC9C,kBAAQ,YAAW;AAAA,QACpB;AAAA,MACD;AAAA,IACD,CAAC;AAAA,EACD;AAAA,EACD,QAAQ,WAAW;AAClBA,kBAAAA,MAAY,MAAA,OAAA,iBAAA,UAAU;AAAA,EACtB;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIR,gBAAgB;AACEC,iBAAS,UAAC,MAAM;AAAA,IAMjC;AAAA;AAAA;AAAA;AAAA,IAKD,cAAc;AACbD,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,QACN,SAAS,CAAC,QAAQ;AACjBC,qBAAS,UAAC,YAAY,IAAI,WAAW,IAAI,QAAQ;AAAA,QACjD;AAAA,QACD,MAAM,CAAC,QAAQ;AACdD,wBAAc,MAAA,MAAA,SAAA,iBAAA,UAAU,GAAG;AAAA,QAC5B;AAAA,MACD,CAAC;AAAA,IACF;AAAA,EACD;AACD;AClFM,SAAS,YAAY;AAC3B,QAAM,MAAME,cAAY,aAACC,SAAG;AAG5B,MAAI,OAAO,iBAAiB,aAAaF,WAAAA;AACzC,MAAI,QAAQ,aAAaA,WAAAA,SAAS;AAElC,SAAO;AAAA,IACN;AAAA,EACA;AACF;;;"}